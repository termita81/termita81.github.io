<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  <title>{{title}} - My Blog</title>
  <link rel="stylesheet" href="/styles/main.css">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
  <meta name="theme-color" content="#0066cc">
  <script>
    // Apply theme immediately to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('site-theme')

      // Handle the three modes: 'light', 'dark', or 'system'
      if (savedTheme === 'light') {
        document.documentElement.classList.add('light-theme')
      } else if (savedTheme === 'dark') {
        document.documentElement.classList.add('dark-theme')
      }
      // If savedTheme is 'system' or null, don't add any class
      // CSS will use the prefers-color-scheme media query
    })()
  </script>
</head>
<body>
  <header class="site-header">
    <nav class="site-nav">
      <a href="/" class="nav-link">Home</a>
      <a href="/about.html" class="nav-link">About</a>
      <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
        <span class="theme-icon">‚óê</span>
      </button>
    </nav>
  </header>

  <main class="site-main">
    {{content}}
  </main>

  <script src="/scripts/theme.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js')
        .then(function(registration) {
          console.log('Service Worker registered with scope:', registration.scope)
        })
        .catch(function(error) {
          console.log('Service Worker registration failed:', error)
        })
    }
  </script>
</body>
</html>
